// UploadMgr.h: interface for the CUploadMgr class.
//
//////////////////////////////////////////////////////////////////////

#if !defined(AFX_UPLOADMGR_H__08C1E7D6_C5D0_11D1_8070_006097B38214__INCLUDED_)
#define AFX_UPLOADMGR_H__08C1E7D6_C5D0_11D1_8070_006097B38214__INCLUDED_

#if _MSC_VER >= 1000
#pragma once
#endif // _MSC_VER >= 1000


#include "DailyPlanUploadSet.h"
#include "DailyPlanLineupsUploadSet.h"


class CUploadMgr  
{
	////////////////////////////////////////////////////////////////
	//	
	//	An auxiliary class used to open/close recordsets used during uploads
	//	
	////////////////////////////////////////////////////////////////


	////////////////////////////////////////////////////////////////
	//	
	//	Typedefs, enums, etc.
	//	
	////////////////////////////////////////////////////////////////

	////////////////////////////////////////////////////////////////
	//	
	//	Data
	//	
	////////////////////////////////////////////////////////////////

private:

	CDatabase*					m_pDB;
		// the database the recordsets belong to

	CDailyPlanUploadSet			m_dpSet;
	CDailyPlanLineupsUploadSet	m_luSet;
		// the recordsets being maintained

	bool m_isInitialized;
	bool m_isFinalized;
		// flags indicating status: uninitialized, initialized, finalized


	////////////////////////////////////////////////////////////////
	//	
	//	Accessors
	//	
	////////////////////////////////////////////////////////////////

public:

	CDailyPlanUploadSet& DPSet() 
	{ 
		assert(m_isInitialized);
		return m_dpSet; 
	}

	CDailyPlanLineupsUploadSet& LUSet() 
	{ 
		assert( m_isInitialized );
		return m_luSet; 
	}


	////////////////////////////////////////////////////////////////
	//	
	//	C-tors, d-tor
	//	
	////////////////////////////////////////////////////////////////

public:

	CUploadMgr(CDatabase*);
	~CUploadMgr();


	////////////////////////////////////////////////////////////////
	//	
	//	Operators
	//	
	////////////////////////////////////////////////////////////////

	////////////////////////////////////////////////////////////////
	//	
	//	Operations
	//	
	////////////////////////////////////////////////////////////////

public:
	
	bool Initialize();
	bool Finalize();

	
	////////////////////////////////////////////////////////////////
	//	
	//	Implementation
	//	
	////////////////////////////////////////////////////////////////

};

#endif // !defined(AFX_UPLOADMGR_H__08C1E7D6_C5D0_11D1_8070_006097B38214__INCLUDED_)
